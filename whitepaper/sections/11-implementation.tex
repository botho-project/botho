% ============================================================================
% Section 11: Implementation
% ============================================================================

\section{Implementation}
\label{sec:implementation}

This section describes the reference implementation of \Botho and its
performance characteristics.

\subsection{Reference Implementation}

\subsubsection{Architecture Overview}

The reference implementation is written in Rust for memory safety and
performance:

\begin{lstlisting}[language=,caption={Crate structure}]
botho/
+-- account-keys/      # Key derivation (BIP39, SLIP-10)
+-- botho/             # Full node implementation
+-- botho-wallet/      # Command-line wallet
+-- cluster-tax/       # Progressive fee calculation
+-- consensus/scp/     # Stellar Consensus Protocol
+-- crypto/
|   +-- box/           # Encryption primitives
|   +-- keys/          # Key management
|   +-- lion/          # (Deprecated) Lattice signatures
|   +-- pq/            # Post-quantum (ML-KEM, ML-DSA)
|   +-- ring-signature/# CLSAG implementation
+-- transaction/
|   +-- core/          # Transaction types and validation
|   +-- signer/        # Transaction signing
|   +-- types/         # Shared types
+-- web/               # Desktop wallet (Tauri)
\end{lstlisting}

\subsubsection{Dependencies}

Key external dependencies:

\begin{itemize}
  \item \textbf{curve25519-dalek}: Ristretto255 group operations
  \item \textbf{bulletproofs}: Range proof implementation
  \item \textbf{pqcrypto}: ML-KEM and ML-DSA implementations
  \item \textbf{libp2p}: Peer-to-peer networking
  \item \textbf{rocksdb}: Key-value storage for blockchain data
\end{itemize}

\subsubsection{Build Requirements}

\begin{itemize}
  \item Rust 1.75+ (stable)
  \item CMake 3.16+ (for native dependencies)
  \item 8 GB RAM minimum for compilation
  \item Linux, macOS, or Windows (with WSL2)
\end{itemize}

\subsection{Performance Characteristics}

\subsubsection{Transaction Validation}

\begin{table}[h]
\centering
\caption{Validation timing (AMD Ryzen 9 5900X)}
\label{tab:validation-timing}
\begin{tabular}{@{}lr@{}}
\toprule
\textbf{Operation} & \textbf{Time} \\
\midrule
CLSAG signature verify (ring=20) & 2.1 ms \\
Bulletproof verify (2 outputs) & 1.8 ms \\
ML-KEM decapsulate & 0.05 ms \\
Full transaction validate & 4.2 ms \\
\bottomrule
\end{tabular}
\end{table}

\subsubsection{Transaction Creation}

\begin{table}[h]
\centering
\caption{Transaction creation timing}
\label{tab:creation-timing}
\begin{tabular}{@{}lr@{}}
\toprule
\textbf{Operation} & \textbf{Time} \\
\midrule
CLSAG signature create (ring=20) & 3.8 ms \\
Bulletproof create (2 outputs) & 45 ms \\
ML-KEM encapsulate & 0.04 ms \\
Full transaction create & 52 ms \\
\bottomrule
\end{tabular}
\end{table}

\subsubsection{Throughput}

\begin{table}[h]
\centering
\caption{System throughput}
\label{tab:throughput}
\begin{tabular}{@{}lrr@{}}
\toprule
\textbf{Metric} & \textbf{Value} & \textbf{Conditions} \\
\midrule
Max TPS (validation) & 238 tx/s & Single core \\
Max TPS (validation) & 1,428 tx/s & 6 cores \\
Block validation & 120 ms & 100 tx block \\
Initial sync & 4 hours & 1M blocks \\
\bottomrule
\end{tabular}
\end{table}

\subsubsection{Resource Usage}

\begin{table}[h]
\centering
\caption{Resource requirements}
\label{tab:resources}
\begin{tabular}{@{}lcc@{}}
\toprule
\textbf{Node Type} & \textbf{Storage} & \textbf{Memory} \\
\midrule
Full node (unpruned) & 50 GB & 4 GB \\
Full node (pruned) & 10 GB & 2 GB \\
Light client & 500 MB & 256 MB \\
Minting node & 50 GB & 8 GB \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Wallet Implementations}

\subsubsection{Command-Line Wallet}

The \texttt{botho-wallet} CLI provides:

\begin{lstlisting}[language=,caption={CLI wallet commands}]
botho-wallet init          # Create new wallet
botho-wallet balance       # Show balance
botho-wallet address       # Generate receiving address
botho-wallet send          # Create transaction
botho-wallet history       # Transaction history
botho-wallet sync          # Synchronize with network
botho-wallet export        # Export view key
\end{lstlisting}

\subsubsection{Desktop Wallet}

A cross-platform desktop wallet built with Tauri provides:

\begin{itemize}
  \item Graphical interface for all wallet operations
  \item Secure mnemonic generation and storage
  \item Transaction history with privacy indicators
  \item Node connection management
  \item Subaddress management
\end{itemize}

\subsubsection{Exchange Scanner}

The \texttt{botho-exchange-scanner} supports exchange integration:

\begin{itemize}
  \item View-key-only scanning for deposits
  \item Webhook notifications for incoming transactions
  \item Subaddress management for customer deposits
  \item No spend key required (security isolation)
\end{itemize}

\subsection{Security Measures}

\subsubsection{Memory Protection}

\begin{itemize}
  \item Key material stored in \texttt{Zeroizing} wrappers
  \item Memory locking (\texttt{mlock}) for sensitive data
  \item Immediate zeroization on drop
  \item No key material in debug output
\end{itemize}

\subsubsection{Constant-Time Operations}

All cryptographic operations use constant-time algorithms:

\begin{itemize}
  \item Scalar multiplication (curve25519-dalek)
  \item Signature verification
  \item Key comparison
  \item Decapsulation
\end{itemize}

\subsubsection{Input Validation}

Extensive input validation prevents:

\begin{itemize}
  \item Buffer overflows (Rust memory safety)
  \item Invalid curve points (checked on deserialization)
  \item Integer overflows (checked arithmetic)
  \item Denial of service (resource limits)
\end{itemize}

\subsection{Testing}

\subsubsection{Test Coverage}

\begin{itemize}
  \item Unit tests: 2,400+ tests
  \item Integration tests: 150+ tests
  \item Property-based tests: Key derivation, serialization
  \item Fuzzing: Transaction parsing, network messages
\end{itemize}

\subsubsection{Test Networks}

\begin{itemize}
  \item \textbf{Testnet}: Public test network with accelerated timing
  \item \textbf{Stagenet}: Pre-production testing environment
  \item \textbf{Regtest}: Local regression testing mode
\end{itemize}

\subsection{Deployment}

\subsubsection{Docker}

\begin{lstlisting}[language=,caption={Docker deployment}]
docker run -d \
  -p 9732:9732 \
  -v /data/botho:/data \
  botho/node:latest \
  --data-dir /data
\end{lstlisting}

\subsubsection{Systemd}

\begin{lstlisting}[language=,caption={Systemd service}]
[Unit]
Description=Botho Node
After=network.target

[Service]
Type=simple
User=botho
ExecStart=/usr/local/bin/botho --config /etc/botho/config.toml
Restart=on-failure
MemoryMax=8G

[Install]
WantedBy=multi-user.target
\end{lstlisting}

\subsection{Future Development}

\subsubsection{Planned Improvements}

\begin{itemize}
  \item \textbf{Mobile wallet}: iOS and Android applications
  \item \textbf{Hardware wallet support}: Ledger/Trezor integration
  \item \textbf{Atomic swaps}: Cross-chain exchange without intermediaries
  \item \textbf{Payment channels}: Layer-2 scaling for micropayments
\end{itemize}

\subsubsection{Post-Quantum Ring Signatures}

Future protocol upgrade may introduce post-quantum ring signatures once
efficient constructions become practical:

\begin{itemize}
  \item Lattice-based ring signatures (research ongoing)
  \item Hybrid classical + PQ approach
  \item Backward compatibility via soft fork
\end{itemize}

\subsection{Code Availability}

The reference implementation is open source:

\begin{itemize}
  \item Repository: \url{https://github.com/botho-project/botho}
  \item License: MIT
  \item Contributing: See CONTRIBUTING.md
  \item Security issues: security@botho.org
\end{itemize}

